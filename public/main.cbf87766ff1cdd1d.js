(self.webpackChunkproductosChain=self.webpackChunkproductosChain||[]).push([[179],{59346:(Z,m,o)=>{"use strict";o.d(m,{e:()=>t});var r=o(5e3);let t=(()=>{class c{transform(l=""){return l?l.toLowerCase().substr(0,5)+"..."+l.toLowerCase().substr(-4):""}}return c.\u0275fac=function(l){return new(l||c)},c.\u0275pipe=r.Yjl({name:"idformat",type:c,pure:!0}),c})()},95099:(Z,m,o)=>{"use strict";o.d(m,{p:()=>t});var r=o(5e3);let t=(()=>{class c{transform(l=""){return l.split(",")}}return c.\u0275fac=function(l){return new(l||c)},c.\u0275pipe=r.Yjl({name:"tx2Array",type:c,pure:!0}),c})()},4597:(Z,m,o)=>{"use strict";o.d(m,{w:()=>M});var r=o(15861),t=o(5e3),c=o(48966),s=o(68306),l=o(92340),P=o(99772),u=o(45655),p=o(47319),I=o(99291),C=o(69808),b=o(25245),T=o(4834),O=o(93075),_=o(47423),G=o(85899),W=o(59346),A=o(95099);function U(i,x){1&i&&(t.ynx(0),t.TgZ(1,"mat-icon",15),t._uU(2,"help"),t.qZA(),t._uU(3," \xbfEsta seguro de continuar? "),t.BQk())}function F(i,x){1&i&&(t.TgZ(0,"mat-icon",15),t._uU(1,"check_circle"),t.qZA(),t._uU(2," Petici\xf3n realizada exitosamente "))}function $(i,x){if(1&i&&(t.TgZ(0,"span",18),t.TgZ(1,"a",19),t._uU(2),t.ALo(3,"idformat"),t.qZA(),t.qZA()),2&i){const a=x.$implicit,d=t.oxw(2);t.xp6(1),t.hYB("href","",d.urlTransaccion,"/",a,"",t.LSH),t.xp6(1),t.hij(" ",t.lcZ(3,3,a)," ")}}function k(i,x){if(1&i&&(t.TgZ(0,"div",5),t.TgZ(1,"div",6),t._uU(2," Transaction Hash: "),t.qZA(),t.TgZ(3,"div",16),t.YNc(4,$,4,5,"span",17),t.ALo(5,"tx2Array"),t.ALo(6,"async"),t.qZA(),t.qZA()),2&i){const a=t.oxw();t.xp6(4),t.Q6J("ngForOf",t.lcZ(5,1,t.lcZ(6,3,a.estadoDialogo$).tx))}}function w(i,x){if(1&i){const a=t.EpF();t.ynx(0),t._UZ(1,"mat-divider",20),t.TgZ(2,"div",21),t.TgZ(3,"div",6),t._uU(4," Gas limit (ETH): "),t.qZA(),t.TgZ(5,"div",6),t.TgZ(6,"input",22),t.NdJ("ngModelChange",function(D){return t.CHM(a),t.oxw().gasLimit=D})("ngModelChange",function(){return t.CHM(a),t.oxw().calcularEstimadeGasFee()})("keypress",function(D){return t.CHM(a),t.oxw().soloNumeros(D)}),t.qZA(),t.TgZ(7,"div",23),t._uU(8,"Gas limit sugerido: "),t.TgZ(9,"span"),t._uU(10),t.ALo(11,"async"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(12,"div",21),t.TgZ(13,"div",6),t._uU(14," Gas price (GWEI): "),t.TgZ(15,"a",24),t.TgZ(16,"mat-icon",15),t._uU(17,"help"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(18,"div",6),t.TgZ(19,"input",25),t.NdJ("ngModelChange",function(D){return t.CHM(a),t.oxw().gasPrice=D})("ngModelChange",function(){return t.CHM(a),t.oxw().calcularEstimadeGasFee()})("keypress",function(D){return t.CHM(a),t.oxw().soloNumeros(D)}),t.qZA(),t.qZA(),t.qZA(),t.TgZ(20,"div",21),t.TgZ(21,"div",6),t._uU(22," Estimated gas fee (ETH): "),t.qZA(),t.TgZ(23,"div",6),t.TgZ(24,"div",26),t._uU(25),t.ALo(26,"number"),t.qZA(),t.qZA(),t.qZA(),t._UZ(27,"mat-divider",20),t.TgZ(28,"div",21),t.TgZ(29,"div",6),t._uU(30," Total (ETH): "),t.qZA(),t.TgZ(31,"div",6),t.TgZ(32,"div",27),t._uU(33),t.ALo(34,"number"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(35,"div",5),t.TgZ(36,"div",28),t._uU(37," Realizar esta acci\xf3n requiere el "),t.TgZ(38,"b"),t._uU(39,"CONSUMO"),t.qZA(),t._uU(40," de Ethers "),t.qZA(),t.qZA(),t.BQk()}if(2&i){const a=t.oxw();t.xp6(6),t.Q6J("disabled",a.data.variosProductos)("ngModel",a.gasLimit),t.xp6(4),t.Oqu(t.lcZ(11,6,a.estadoDialogo$).gas),t.xp6(9),t.Q6J("ngModel",a.gasPrice),t.xp6(6),t.hij(" ",t.Dn7(26,8,a.estimatedGasFee,".8-8","en")," "),t.xp6(8),t.hij(" ",t.Dn7(34,12,a.estimatedGasFee,".8-8","en")," ")}}function f(i,x){1&i&&t._UZ(0,"mat-progress-bar",29)}function N(i,x){if(1&i&&(t.TgZ(0,"div",30),t._uU(1),t.ALo(2,"async"),t.qZA()),2&i){const a=t.oxw();t.xp6(1),t.hij(" ",t.lcZ(2,1,a.estadoDialogo$).error," ")}}function z(i,x){if(1&i&&(t.TgZ(0,"div",30),t._uU(1),t.qZA()),2&i){const a=t.oxw();t.xp6(1),t.hij(" ",a.error||"No tiene fondos suficientes"," ")}}function R(i,x){if(1&i){const a=t.EpF();t.TgZ(0,"button",31),t.NdJ("click",function(){return t.CHM(a),t.oxw().proceder()}),t.ALo(1,"async"),t._uU(2,"Si, estoy seguro"),t.qZA()}if(2&i){const a=t.oxw();t.Q6J("disabled",t.lcZ(1,1,a.estadoDialogo$).loading||!!a.error)}}let H=(()=>{class i{constructor(a,d,D,S){this.matDialogRef=a,this.data=d,this.store=D,this.router=S,this.onProceder=new t.vpe,this.estadoAuth$=new s.y,this.estadoDialogo$=new s.y,this.urlTransaccion=l.N.TRANSACCION,this.gasLimitTmp=0,this.error=void 0,this.gasLimit=l.N.GAS_LIMIT,this.gasPrice=l.N.GAS_PRICE,this.estimatedGasFee=0,this.gasSubscription=null,this.procesoExitosoSubscription=null,this.procesoExitosoDialogo=!1,this.cantidadProductos=1,this.calcularEstimadeGasFee()}ngOnInit(){this.estadoAuth$=this.store.select("auth"),this.estadoDialogo$=this.store.select("dialogo"),this.gasSubscription=this.store.select(u.YD).subscribe(a=>{this.gasLimit=a,this.gasLimitTmp=a,this.calcularEstimadeGasFee()}),this.procesoExitosoSubscription=this.store.select(u.t7).subscribe(a=>{this.procesoExitosoDialogo=a})}verificarGas(){this.error=void 0,void 0===this.gasLimit||this.gasLimit<this.gasLimitTmp?this.error=`El gas limit debe ser al menos de ${this.gasLimitTmp}`:(void 0===this.gasPrice||this.gasPrice<=0)&&(this.gasPrice=0,this.error="El gas price debe ser mayor a 0 (cero)")}proceder(){this.error||(this.onProceder.emit({proceder:!0,gasLimit:this.gasLimit,gasPrice:this.gasPrice}),this.store.dispatch((0,P.NL)()))}calcularEstimadeGasFee(){this.verificarGas(),this.estimatedGasFee=this.gasPrice*Math.pow(10,9)*this.gasLimit/Math.pow(10,18)}soloNumeros(a){return a.charCode>=48&&a.charCode<58}cerrar(){var a=this;return(0,r.Z)(function*(){a.matDialogRef.close(),a.store.dispatch((0,P.GJ)()),a.onProceder.emit({proceder:!1,gasLimit:0,gasPrice:0}),a.procesoExitosoDialogo&&a.data.redirigir&&(yield a.router.navigate([a.data.url],{replaceUrl:!0}))})()}ngOnDestroy(){null!=this.gasSubscription&&this.gasSubscription.unsubscribe(),null!=this.procesoExitosoSubscription&&this.procesoExitosoSubscription.unsubscribe()}}return i.\u0275fac=function(a){return new(a||i)(t.Y36(c.so),t.Y36(c.WI),t.Y36(p.yh),t.Y36(I.F0))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-dialog-pregunta"]],outputs:{onProceder:"onProceder"},decls:38,vars:37,consts:[[1,"dialogo"],["mat-dialog-title",""],[4,"ngIf","ngIfElse"],["confirmacionSuccess",""],[1,"mat-typography"],[1,"row"],[1,"col-xs-12","col-sm-6","col-md-6","col-lg-6"],[1,"col-xs-12","col-sm-6","col-md-6","col-lg-6","font-16"],["class","row",4,"ngIf"],[4,"ngIf"],["class","mt","mode","indeterminate",4,"ngIf"],["class","error-dialog",4,"ngIf"],["align","end"],["mat-raised-button","","color","warn",1,"color-btn-cancel",3,"disabled","click"],["mat-raised-button","","color","primary","class","color-btn-ok",3,"disabled","click",4,"ngIf"],[1,"align-icon","color-btn-icon"],[1,"col-xs-12","col-sm-6","col-md-6","col-lg-6","font-16","col-tx"],["class","tx",4,"ngFor","ngForOf"],[1,"tx"],["target","_blank",3,"href"],[1,"mt"],[1,"row","middle-xs"],["type","number","min","1",1,"input-dialog","input-dialog-border",3,"disabled","ngModel","ngModelChange","keypress"],[1,"gas-sugerido"],["mat-flat-button","","href","https://www.ethgasstation.info/","target","_blank",1,"gas-help"],["type","number","min","1",1,"input-dialog","input-dialog-border",3,"ngModel","ngModelChange","keypress"],[1,"text-dialog"],[1,"text-dialog","gas-fee"],[1,"col-xs-12"],["mode","indeterminate",1,"mt"],[1,"error-dialog"],["mat-raised-button","","color","primary",1,"color-btn-ok",3,"disabled","click"]],template:function(a,d){if(1&a&&(t.TgZ(0,"div",0),t.TgZ(1,"h2",1),t.YNc(2,U,4,0,"ng-container",2),t.ALo(3,"async"),t.YNc(4,F,3,0,"ng-template",null,3,t.W1O),t.qZA(),t.TgZ(6,"mat-dialog-content",4),t.TgZ(7,"div",5),t.TgZ(8,"div",6),t._uU(9," Cuenta actual: "),t.qZA(),t.TgZ(10,"div",7),t._uU(11),t.ALo(12,"idformat"),t.ALo(13,"async"),t.qZA(),t.qZA(),t.TgZ(14,"div",5),t.TgZ(15,"div",6),t._uU(16," Balance actual (ETH): "),t.qZA(),t.TgZ(17,"div",7),t._uU(18),t.ALo(19,"async"),t.qZA(),t.qZA(),t.YNc(20,k,7,5,"div",8),t.ALo(21,"async"),t.YNc(22,w,41,16,"ng-container",9),t.ALo(23,"async"),t.qZA(),t.YNc(24,f,1,0,"mat-progress-bar",10),t.ALo(25,"async"),t.YNc(26,N,3,3,"div",11),t.ALo(27,"async"),t.YNc(28,z,2,1,"div",11),t.ALo(29,"async"),t.ALo(30,"async"),t.ALo(31,"async"),t.TgZ(32,"mat-dialog-actions",12),t.TgZ(33,"button",13),t.NdJ("click",function(){return d.cerrar()}),t.ALo(34,"async"),t._uU(35,"Cerrar"),t.qZA(),t.YNc(36,R,3,3,"button",14),t.ALo(37,"async"),t.qZA(),t.qZA()),2&a){const D=t.MAs(5);t.xp6(2),t.Q6J("ngIf",!t.lcZ(3,11,d.estadoDialogo$).procesoExitoso)("ngIfElse",D),t.xp6(9),t.hij(" ",t.lcZ(12,13,t.lcZ(13,15,d.estadoAuth$).cuenta)," "),t.xp6(7),t.hij(" ",t.lcZ(19,17,d.estadoDialogo$).balance," "),t.xp6(2),t.Q6J("ngIf",t.lcZ(21,19,d.estadoDialogo$).tx.length>0),t.xp6(2),t.Q6J("ngIf",!t.lcZ(23,21,d.estadoDialogo$).procesoExitoso),t.xp6(2),t.Q6J("ngIf",t.lcZ(25,23,d.estadoDialogo$).loading),t.xp6(2),t.Q6J("ngIf",t.lcZ(27,25,d.estadoDialogo$).error),t.xp6(2),t.Q6J("ngIf",!t.lcZ(29,27,d.estadoDialogo$).procesoExitoso&&!t.lcZ(30,29,d.estadoDialogo$).error&&(d.estimatedGasFee>t.lcZ(31,31,d.estadoDialogo$).balance||d.error)),t.xp6(5),t.Q6J("disabled",t.lcZ(34,33,d.estadoDialogo$).loading),t.xp6(3),t.Q6J("ngIf",!t.lcZ(37,35,d.estadoDialogo$).procesoExitoso)}},directives:[c.uh,C.O5,b.Hw,c.xY,C.sg,T.d,O.qQ,O.wV,O.Fj,O.JJ,O.On,_.zs,G.pW,c.H8,_.lW],pipes:[C.Ov,W.e,A.p,C.JJ],styles:[".input-dialog[_ngcontent-%COMP%], .text-dialog[_ngcontent-%COMP%]{text-align:right;background:transparent;border:none;padding:8px 0;width:100%;font-size:16px}.font-16[_ngcontent-%COMP%]{font-size:16px}.input-dialog-border[_ngcontent-%COMP%]{border-bottom:1px solid gray}.gas-sugerido[_ngcontent-%COMP%]{display:block;font-size:12px;text-align:right;color:#0009}.gas-help[_ngcontent-%COMP%]{padding:0;min-width:24px}.gas-sugerido[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{font-weight:bolder}.gas-fee[_ngcontent-%COMP%]{font-size:20px;font-weight:bolder;color:#000000e6;overflow:hidden}.col-tx[_ngcontent-%COMP%]{max-height:63px;overflow-y:auto;scrollbar-color:var(--color-toolbar) white}.tx[_ngcontent-%COMP%]{display:block}.tx[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{text-decoration:none;font-size:14px;display:inline-block;color:#000000b3;font-weight:700;transition:all .2s ease}.tx[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]:hover{text-decoration:underline;font-size:15px}.mt[_ngcontent-%COMP%], .row[_ngcontent-%COMP%]{margin-top:.5em}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}@media only screen and (max-width: 48em){.input-dialog[_ngcontent-%COMP%], .text-dialog[_ngcontent-%COMP%], .gas-sugerido[_ngcontent-%COMP%]{text-align:left}}.error-dialog[_ngcontent-%COMP%]{text-align:left;display:block;background-color:#f00c;color:#fff;margin-top:.5em;padding:2px 6px}"]}),i})(),M=(()=>{class i{constructor(a){this.matDialog=a,this.dialogoRef=null}abrirDialogPregunta(a){this.cerrarDialogo(),this.dialogoRef=this.matDialog.open(H,{data:a,autoFocus:!0,disableClose:!0,closeOnNavigation:!0})}getDialogo(){return this.dialogoRef}cerrarDialogo(){this.dialogoRef&&this.dialogoRef.close()}}return i.\u0275fac=function(a){return new(a||i)(t.LFG(c.uw))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})()},15184:(Z,m,o)=>{"use strict";o.d(m,{$:()=>t});const t=new(o(40520).Xk)(()=>!1)},89810:(Z,m,o)=>{"use strict";o.d(m,{T4:()=>c,X$:()=>s,x4:()=>l,vJ:()=>P,Ag:()=>u,uo:()=>p,Cq:()=>I,YD:()=>C,gs:()=>b,y:()=>T});var r=o(47319),t=o(74728);const c=(0,r.PH)(t.Y.conectarWallet),s=(0,r.PH)(t.Y.generarToken,(0,r.Ky)()),l=(0,r.PH)(t.Y.realizarLogin,(0,r.Ky)()),P=(0,r.PH)(t.Y.validarToken),u=(0,r.PH)(t.Y.noAccion),p=(0,r.PH)(t.Y.conectarWalletSuccess,(0,r.Ky)()),I=(0,r.PH)(t.Y.conectarWalletError,(0,r.Ky)()),C=(0,r.PH)(t.Y.desconectarWallet),b=(0,r.PH)(t.Y.desconectarWalletSuccess),T=(0,r.PH)(t.Y.desconectarWalletError,(0,r.Ky)());(0,r.G0)({conectarWallet:c,conectarWalletSuccess:p,conectarWalletError:I,generarToken:s,validarToken:P,login:l,desconectarWallet:C,desconectarWalletSuccess:b,desconectarWalletError:T,noAccion:u})},99772:(Z,m,o)=>{"use strict";o.d(m,{ph:()=>c,GJ:()=>s,NL:()=>l,Hl:()=>P,AG:()=>u,fO:()=>p,pL:()=>I,Tr:()=>C});var r=o(47319),t=o(74728);const c=(0,r.PH)(t.Y.abrirDialogo,(0,r.Ky)()),s=(0,r.PH)(t.Y.cerrarDialogo),l=(0,r.PH)(t.Y.procesandoAccionEnDialogo),P=(0,r.PH)(t.Y.consultarGas,(0,r.Ky)()),u=(0,r.PH)(t.Y.consultarGasSuccess,(0,r.Ky)()),p=(0,r.PH)(t.Y.consultarGasError,(0,r.Ky)()),I=(0,r.PH)(t.Y.actualizarBalance,(0,r.Ky)()),C=(0,r.PH)(t.Y.asignarMensajeDeError,(0,r.Ky)());(0,r.G0)({abrirDialogo:c,cerrarDialogo:s,procesandoAccionEnDialogo:l,consultarGas:P,consultarGasSuccess:u,consultarGasError:p,actualizarBalance:I,asigarMsjError:C})},50127:(Z,m,o)=>{"use strict";o.d(m,{E:()=>s,w:()=>P});var r=o(47319),t=o(99772),c=o(92340);const s={balance:0,gas:c.N.GAS_LIMIT,procesoExitoso:!1,dialogoAbierto:!1,loading:!1,tx:"",error:null};let l=JSON.parse(localStorage.getItem("dialogo")||"{}");0===Object.keys(l).length&&(l=null);const P=(0,r.Lq)(l||s,(0,r.on)(t.ph,(u,p)=>Object.assign(Object.assign({},u),{gas:c.N.GAS_LIMIT,procesoExitoso:!1,dialogoAbierto:!0,loading:!0,tx:"",error:null})),(0,r.on)(t.GJ,(u,p)=>Object.assign(Object.assign({},s),{procesoExitoso:u.procesoExitoso,balance:u.balance,gas:u.gas,tx:""})),(0,r.on)(t.NL,(u,p)=>Object.assign(Object.assign({},u),{loading:!0,error:null})),(0,r.on)(t.Tr,(u,p)=>Object.assign(Object.assign({},u),{loading:!1,error:p.error})),(0,r.on)(t.Hl,(u,p)=>Object.assign(Object.assign({},u),{loading:!0,tx:""})),(0,r.on)(t.AG,(u,p)=>Object.assign(Object.assign({},u),{loading:!1,gas:p.gas,balance:p.balance})),(0,r.on)(t.fO,(u,p)=>Object.assign(Object.assign({},u),{loading:!1,error:p.error})),(0,r.on)(t.pL,(u,p)=>Object.assign(Object.assign({},u),{balance:p.balance,procesoExitoso:p.procesoExitoso,loading:!1,tx:p.tx,error:null})))},45655:(Z,m,o)=>{"use strict";o.d(m,{YD:()=>s,t7:()=>l,Ij:()=>P});var r=o(47319),t=o(50127);const c=(0,r.ZF)("dialogo"),s=(0,r.P1)(c,u=>u.gas),l=(0,r.P1)(c,u=>u.procesoExitoso),P=(0,r.P1)(c,u=>Object.assign(Object.assign({},t.E),{balance:u.balance}))},74728:(Z,m,o)=>{"use strict";o.d(m,{Y:()=>r});var r=(()=>{return(t=r||(r={})).conectarWallet="[Auth] Conectar wallet",t.conectarWalletSuccess="[Auth] Conectar wallet success",t.conectarWalletError="[Auth] Conectar wallet error",t.generarToken="[Auth] Generar token",t.realizarLogin="[Auth] Realizar login",t.validarToken="[Auth] Validar token",t.noAccion="[Auth] No realiza ninguna accion luego de que el token es valido",t.desconectarWallet="[Auth] Desconectar wallet",t.desconectarWalletSuccess="[Auth] Desconectar wallet success",t.desconectarWalletError="[Auth] Desconectar wallet error",t.listarProductos="[Productos] Listar los productos",t.listarProductosSuccess="[Productos] Listar los productos success",t.listarProductosError="[Productos] Listar los productos error",t.seleccionarProducto="[Productos] Seleccionar un producto",t.deseleccionarProducto="[Productos] Deseleccionar un producto",t.deseleccionarTodosLosProductos="[Productos] Deseleccionar todos los productos",t.eliminarProducto="[Productos] Eliminar un producto",t.eliminarProductoSuccess="[Productos] Eliminar un producto success",t.eliminarProductoError="[Productos] Eliminar un producto error",t.eliminarVariosProductos="[Productos] Eliminar varios productos",t.eliminarVariosProductosSuccess="[Productos] Eliminar varios productos success",t.crearProducto="[Productos] Crear un producto",t.guardarProducto="[Productos] Guardar un producto",t.guardarProductoSuccess="[Productos] Guardar un producto success",t.guardarProductoError="[Productos] Guardar un producto error",t.editarProducto="[Productos] Editar un producto",t.editarProductoSuccess="[Productos] Editar un producto success",t.editarProductoError="[Productos] Editar un producto error",t.actualizarProducto="[Productos] Actualizar un producto",t.actualizarProductoSuccess="[Productos] Actualizar un producto success",t.actualizarProductoError="[Productos] Actualizar un producto error",t.iniciarBusquedaProducto="[Productos] Iniciar busqueda de productos",t.terminarBusquedaProducto="[Productos] Terminar busqueda de productos",t.limpiarError="[Productos] Limpiar error producto",t.asignarError="[Productos] Asignar error producto",t.abrirDialogo="[Dialogo] Abrir dialogo",t.cerrarDialogo="[Dialogo] Cerrar dialogo",t.procesandoAccionEnDialogo="[Dialogo] Procesando accion en dialogo",t.consultarGas="[Dialogo] Consultar gas",t.consultarGasSuccess="[Dialogo] Consultar gas success",t.consultarGasError="[Dialogo] Consultar gas error",t.actualizarBalance="[Dialogo] Actualizar balance",t.asignarMensajeDeError="[Dialogo] Asignar mensaje de error",r;var t})()},92340:(Z,m,o)=>{"use strict";o.d(m,{N:()=>r});const r={production:!0,url:"https://productos-chain.up.railway.app",CHAINIDS:["0x5"],TRANSACCION:"https://goerli.etherscan.io/tx",GAS_LIMIT:1e6,GAS_PRICE:20}},81199:(Z,m,o)=>{"use strict";var r=o(22313),t=o(5e3),c=o(99291),s=o(89810),l=o(18505),P=o(15861),u=o(34445),p=o.n(u),I=o(37976),C=o(62843),b=o(39646),T=o(40520),O=o(70262),_=o(54004),G=o(92340);let W=(()=>{class e{constructor(n){this.httpClient=n,this.web3=null,this.chainIds=G.N.CHAINIDS,this.url=G.N.url,this.cuenta="",window.ethereum&&(this.web3=new(p())(window.ethereum))}getCuenta(){var n=this;return(0,P.Z)(function*(){if(!window.ethereum)throw{success:!1,msj:"Instale MetaMask para ingresar en la aplicaci\xf3n."};const E=yield window.ethereum.request({method:"eth_chainId"});if(!n.chainIds.includes(E))throw{success:!1,msj:"La red seleccionada no es la adecuada, debe selecionar LA RED GOERLI"};const g=yield window.ethereum.request({method:"eth_requestAccounts"});return n.cuenta=g[0],{success:!0,msj:"Cuenta seleccionada exitosamente.",data:n.cuenta}})()}generarJWT(n){var E=this;return(0,P.Z)(function*(){let g=null;if(!n)throw{success:!1,msj:"Token no generado, seleccione una cuenta."};try{return g=yield(0,I.sign)(y=>E.web3.eth.personal.sign(y,n,""),"1d"),{success:!0,msj:"Token generado exitosamente.",data:g}}catch(y){throw((null==y?void 0:y.message)||"").includes("User denied message signature")?{success:!1,msj:"El usuario cancelo el login."}:{success:!1,msj:"Ocurrio un error al generar el token."}}})()}login(n){n||(0,C._)({success:!1,msj:"Token no generado."});const E=(new T.WM).set("x-token",n);return this.httpClient.post(`${this.url}/auth/login`,{},{headers:E}).pipe((0,l.b)(g=>g.success?(localStorage.setItem("token",g.data),(0,b.of)({success:!0,msj:"Proceso login exitoso.",data:g.cuenta})):(0,C._)({success:!1,msj:"Ocurrio un error desconocido al realizar el login."})),(0,O.K)(g=>0===Object.keys(g).length?(0,C._)({success:!1,msj:"Ocurrio un error desconocido al realizar el login."}):g.message.includes("404")?(0,C._)({success:!1,msj:"Servicio esta temporalmente deshabilitado, vuelva a intentarlo en unos minutos."}):(0,C._)({success:!1,msj:"Ocurrio un error desconocido al realizar el login."})))}validarToken(){const n=localStorage.getItem("token")||"",E=(new T.WM).set("x-token",n);return this.httpClient.get(`${this.url}/auth/verificar-token`,{headers:E}).pipe((0,_.U)(g=>(localStorage.setItem("token",g.data),g.success)),(0,O.K)(g=>(0,b.of)(!1)))}logout(){return localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("productos"),localStorage.removeItem("dialogo"),(0,b.of)({success:!0,msj:"Proceso logout exitoso.",data:null})}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(T.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var A=o(47319);let U=(()=>{class e{constructor(n,E){this.authService=n,this.store=E}canActivate(n,E){return this.authService.validarToken().pipe((0,l.b)(g=>{g||this.store.dispatch((0,s.YD)())}))}canLoad(n,E){return this.authService.validarToken().pipe((0,l.b)(g=>{g||this.store.dispatch((0,s.YD)())}))}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(W),t.LFG(A.yh))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const F=[{path:"auth",loadChildren:()=>Promise.all([o.e(930),o.e(705)]).then(o.bind(o,87310)).then(e=>e.AuthModule)},{path:"wallet",loadChildren:()=>Promise.all([o.e(930),o.e(798)]).then(o.bind(o,33798)).then(e=>e.PaginasProtegidasModule),canActivate:[U],canLoad:[U]},{path:"**",redirectTo:"auth"}];let $=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[c.Bz.forRoot(F,{useHash:!0})],c.Bz]}),e})(),k=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-root"]],decls:1,vars:0,template:function(n,E){1&n&&t._UZ(0,"router-outlet")},directives:[c.lC],styles:[""]}),e})();var w=o(76360),f=o(36642),N=o(11848),z=o(15184);let R=(()=>{class e{constructor(n){this.store=n}intercept(n,E){let g=n;if(!0===g.context.get(z.$)){const y=localStorage.getItem("token")||"";if(0===y.length)return this.store.dispatch((0,s.YD)()),N.C;{const j=(new T.WM).set("x-token",y);g=n.clone({headers:j})}}return E.handle(g).pipe((0,l.b)(y=>{if(y instanceof T.Zn&&y.headers.has("x-token")){const j=y.headers.get("x-token")||"";0===j.length?this.store.dispatch((0,s.YD)()):localStorage.setItem("token",j)}}),(0,O.K)(this.manejarError))}manejarError(n){return n.headers.has("x-token")&&0===(n.headers.get("x-token")||"").length&&localStorage.removeItem("token"),(0,C._)(n)}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(A.yh))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e})();var H=o(48966),M=o(74728);const i={cuenta:null,loading:!1,logueado:!1,estado:"No conectado",error:null};let x=JSON.parse(localStorage.getItem("user")||"{}");0===Object.keys(x).length&&(x=null);const a=(0,A.Lq)(x||i,(0,A.on)(s.T4,e=>Object.assign(Object.assign({},e),{loading:!0,logueado:!1,estado:"Intentando conecci\xf3n ...",error:null})),(0,A.on)(s.X$,e=>Object.assign(Object.assign({},e),{estado:"Seleccionando cuenta ..."})),(0,A.on)(s.x4,e=>Object.assign(Object.assign({},e),{estado:"Iniciando sesi\xf3n ..."})),(0,A.on)(s.uo,(e,h)=>Object.assign(Object.assign({},e),{cuenta:h.cuenta,loading:!1,logueado:!0,estado:"Conectado.",error:null})),(0,A.on)(s.Cq,(e,h)=>Object.assign(Object.assign({},e),{cuenta:null,loading:!1,logueado:!1,estado:"No conectado",error:h.error})),(0,A.on)(s.YD,e=>Object.assign(Object.assign({},e),{loading:!0})),(0,A.on)(s.gs,e=>i),(0,A.on)(s.y,(e,h)=>Object.assign(Object.assign({},e),{loading:!1,error:h.error}))),D=[function d(e){return function(h,n){return n.type===M.Y.desconectarWalletSuccess&&(h={}),e(h,n)}}];var S=o(50457),Y=o(95577),K=o(11365),B=o(4597);let Q=(()=>{class e{constructor(n,E,g,y,j,X){var J=this;this.actions$=n,this.authService=E,this.dialogoService=g,this.router=y,this.store=j,this.zone=X,this.conectarWallet$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(M.Y.conectarWallet),(0,Y.z)(L=>(0,S.D)(this.authService.getCuenta()).pipe((0,_.U)(v=>(0,s.X$)({cuenta:v.data})),(0,O.K)(v=>(0,b.of)((0,s.Cq)({error:v.msj}))))))),this.generarToken$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(M.Y.generarToken),(0,Y.z)(L=>(0,S.D)(this.authService.generarJWT(L.cuenta)).pipe((0,_.U)(v=>(0,s.x4)({token:v.data})),(0,O.K)(v=>(0,b.of)((0,s.Cq)({error:v.msj}))))))),this.login$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(M.Y.realizarLogin),(0,Y.z)(L=>this.authService.login(L.token).pipe((0,_.U)(v=>(0,s.uo)({cuenta:v.cuenta})),(0,O.K)(v=>(0,b.of)((0,s.Cq)({error:v.msj}))))))),this.validarToken$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(M.Y.validarToken),(0,Y.z)(L=>this.authService.validarToken().pipe((0,_.U)(v=>v?(0,s.Ag)():(0,s.gs)()))))),this.redirectLoginSuccess$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(M.Y.conectarWalletSuccess),(0,l.b)(function(){var L=(0,P.Z)(function*(v){return yield J.router.navigate(["wallet/productos"],{replaceUrl:!0})});return function(v){return L.apply(this,arguments)}}())),{dispatch:!1}),this.desconectarWallet$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(M.Y.desconectarWallet),(0,l.b)(()=>{this.dialogoService.cerrarDialogo()}),(0,Y.z)(L=>this.authService.logout().pipe((0,_.U)(v=>(0,s.gs)()),(0,O.K)(v=>(0,b.of)((0,s.y)({error:v.msj}))))))),this.redirectLogout$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(M.Y.desconectarWalletSuccess),(0,l.b)(function(){var L=(0,P.Z)(function*(v){return yield J.zone.run((0,P.Z)(function*(){yield J.router.navigate(["auth/login"],{replaceUrl:!0})}))});return function(v){return L.apply(this,arguments)}}())),{dispatch:!1}),this.saveStateAuth$=(0,f.GW)(()=>this.actions$.pipe((0,f.l4)(M.Y.conectarWalletSuccess,M.Y.desconectarWalletError),(0,K.M)(this.store.select("auth")),(0,l.b)(L=>{localStorage.setItem("user",JSON.stringify(L[1]||""))})),{dispatch:!1})}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(f.eX),t.LFG(W),t.LFG(B.w),t.LFG(c.F0),t.LFG(A.yh),t.LFG(t.R0b))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e})(),V=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e,bootstrap:[k]}),e.\u0275inj=t.cJS({providers:[{provide:T.TP,useClass:R,multi:!0}],imports:[[r.b2,$,w.PW,T.JF,H.Is,A.Aw.forRoot({auth:a},{metaReducers:D}),f.sQ.forRoot([Q])]]}),e})();G.N.production&&(0,t.G48)(),r.q6().bootstrapModule(V).catch(e=>console.error(e))},88677:()=>{},62808:()=>{},46601:()=>{},71922:()=>{},2363:()=>{},27790:()=>{},52361:()=>{},94616:()=>{},6567:()=>{},55896:()=>{},87500:()=>{}},Z=>{Z.O(0,[736],()=>Z(Z.s=81199)),Z.O()}]);